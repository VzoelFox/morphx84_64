fungsi main
    ; --- TEST LOGIC (Bit Scan / Popcnt) ---
    ; Test BSF (Bit Scan Forward) on 0x10 (binary 10000 -> bit 4)
    mov rdi, 16
    bsf rax, rdi
    cmp rax, 4
    jika_sama
        debug
    tutup_jika

    ; Test POPCNT on 0x7 (binary 111 -> 3 bits)
    mov rdi, 7
    popcnt rax, rdi
    cmp rax, 3
    jika_sama
        debug
    tutup_jika

    ; Test BTS (Bit Test and Set)
    ; Clear rdi
    xor rdi, rdi
    ; Set bit 2
    bts rdi, 2
    ; rdi should be 4 (100b)
    cmp rdi, 4
    jika_sama
        debug
    tutup_jika

    ; --- TEST TRIGONOMETRY (x87 FPU) ---
    ; Calculate Sin(PI) -> Should be ~0
    finit
    fldpi           ; Load PI
    fsin            ; Sin(PI)
    ; Store to stack (rsp) to pop st(0)
    ; We corrected the mnemonic to match the parser rule (fstp.mem64)
    fstp [rsp]
    debug

    ; Calculate Sqrt(4.0) -> 2.0
    finit
    fld1
    fld1
    faddp ; 1+1=2
    fld1
    fld1
    faddp ; 2
    fmulp ; 2*2=4
    fsqrt ; sqrt(4)=2
    debug

    mov rax, 60
    mov rdi, 0
    syscall
tutup_fungsi
